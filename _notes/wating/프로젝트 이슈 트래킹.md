---
title: mokakbab-issue
permalink: /wating/issue
---

1. `@nestjs/jwt 모듈` 이슈
2. `typeorm-extension` seeder와 `saveMany` 메서드 문제점
3. typeorm `save` 메서드의 문제점
4. typeorm의 `findOne` 메서드와 `relations` 사용시 고정쿼리 2개를 보내는 문제
5. CPU병목 현상과 데이터베이스 CPU 바운드 문제
6. TypeORM과 mysql 사용시 InnoDB 스토리지 엔진에서 인덱스 중복 생성 문제
7. Object Storage 사용시 `AWS SDK` 를 낮은 버전을 사용하는 문제
9. `docker-compose` 를 통한 scale-out과 nginx 로드 밸런서 설정 고민
10. typeorm mysql에서 AI를 이용한 PK 사용과  `insert` 문제점
11. typeorm migrations의 `cli` 동작이 왜 빌드결과가 아닌 ts를 이용하여 동작 하는지
12. `bcypt` salt 10으로 설저 했을때와 2로 설정 했을때 CPU 과부하 문제.
13. TypeORM 커넥션 누수 문제가 있다. 아무리 찾아봐도 `connection` 관련 메트릭을 제공하는 레퍼런스가 없다. Prisma는 공식 문서에서 제공한다. 이제 프로덕션 환경에서는 `Prisma` 가 더 안정성을 제공할것 같다.


# database

```
WARN[0000] Request Failed                                error="Get \"http://host.docker.internal:4000/articles?cursor=50000&limit=10\": EOF"
ERRO[0000] TypeError: Cannot read property 'length' of undefined
running at default (file:///scripts/articles-performance.js:59:49(64))  executor=constant-arrival-rate scenario=simple_rps_test source=stacktrace

```

```sql
SHOW VARIABLES LIKE 'max_connections';
```

> 최대 연결 개수

```sql
SHOW STATUS LIKE 'Threads_connected';
```

> 현재 사용중인 연결 수 확인

```mysql
mysql> SHOW STATUS LIKE 'Threads_connected';
+-------------------+-------+
| Variable_name     | Value |
+-------------------+-------+
| Threads_connected | 34    |
```

- 커넥션 풀은 충분하다 커넥션 풀 문제는 아니었다.
