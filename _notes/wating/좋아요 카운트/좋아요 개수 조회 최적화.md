---
title: 좋아요 개수 조회 최적화
permalink: /wating/like-count
---


- [좋아요 개수 조회 최적화히기](https://tecoble.techcourse.co.kr/post/2022-10-10-like-count/) 
- https://sokdak-sokdak.tistory.com/22

1. Lock
2. Native Query
3. Sync Schedule
4. Redis 캐시 사용

- Materialized View를 이용하여 데이터베이스에서 쿼리의 결과를 미리 계산하여 저장
- Write-Ahead Logging(WAL) 로깅기반 좋아요 개수 카운트

- 페이스북, 유튜브
	- `Eventual Consistency` 기반 데이터 처리
	- 사용자가 좋아요 한것은 빠르게 서버에 반영되지만, 실제 데이터베이스에 기록 하는 작업은 비동기적인 배치 작업으로 처리
- 트위터
	- 팔로워 같은 경우 `Fan-out on Read` 와 `Fan-out on Write` 방식을 조합한 모델을 사용
	- 사용자가 좋아요나 트윗을 할때 , 동기적으로 이벤트 로그를 기록하고 , 배치 프로세스가 주기적으로 데이터베이스와 동기화

- *Eventual Consistency 기반 설계* 
- "좋아요" 활동은 **로그 기반 시스템**에 기록됩니다. 로그는 배치 작업이나 실시간 스트림 프로세싱을 통해 데이터베이스로 동기화됩니다.
- 일딴 빠른 조회를 위해서 아티클 테이블에 좋아요 총 개수 필드를 추가.
	- 배치 작업으로 업데이트 하는 방법 (실시간성 보장 힘듬)
	- 좋아요 할 때마다 업데이트를 하지만 `Lock` 을 사용하는 방법
	- 좋아요 할 때마다 해당 테이블 총 좋아요 개수 필드에+1해서 업데이트 해주는 `Native Query` 방법
- 레디스 캐시 시스템을 활용
	- 데이터 베이스의 좋아요 개수와 동기화를 해줘야하는 문제가 있다.
- [넷플릭스 분산 카운터](https://netflixtechblog.com/netflixs-distributed-counter-abstraction-8d0c45eb66b2) 
- [시스템 디자인 아티클 사이트](https://systemdesign.one/distributed-counter-system-design/) 

