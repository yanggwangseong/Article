
1. ê³ ì •ê¸¸ì´ ìœˆë„ ë°©ì‹ ë¬¸ì œ (Late Limit êµ¬í˜„ ë°©ë²•)
2. ê·¼ë° ê³ ì •ê¸¸ì´ ìœˆë„ë°©ì‹ í•˜ë©´ ë°”ë¡œ ì´ì „ ìœˆë„ ì¢…ë£Œ ì‹œì ê³¼ ì´í›„ ìœˆë„ ì‹œì‘ ì‹œì ì— ëª°ë ¤ë“¤ì–´ì˜¤ë©´ ì–´ë–»ê²Œ í• ê²ƒì¸ê°€?
3. ë¡œê·¸ ê¸°ë°˜ ì²˜ë¦¬ë¡œ êµ¬í˜„
4. ê·¼ë° ë¡œê·¸ ê¸°ë°˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ë©´ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ë‹¹ ê°€ëŠ¥í•˜ëƒê³  í• ê±´ê°€?


## 1. ê³ ì • ê¸¸ì´ ìœˆë„ ë°©ì‹ì˜ ë¬¸ì œ

ê³ ì • ìœˆë„ëŠ” êµ¬ì¡°ì ìœ¼ë¡œ **ì‹œê°„ì„ ì¼ì • ê°„ê²©ìœ¼ë¡œ ë‹¨ìˆœíˆ ë‚˜ëˆ„ëŠ” ë°©ì‹**ì´ë¼ ë‹¤ìŒê³¼ ê°™ì€ ê·¼ë³¸ì ì¸ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤:

### â— ì£¼ìš” ë¬¸ì œ
- **ê²½ê³„ ë¬¸ì œ (Boundary problem)**
    - ì´ë²¤íŠ¸ê°€ ìœˆë„ ê²½ê³„ ì‹œì (ì˜ˆ: 12:00:00, 12:01:00)ì— ê±¸ì³ ë“¤ì–´ì˜¤ë©´ ì •í™•í•œ ì§‘ê³„ê°€ ì–´ë ¤ì›Œì§.
- **Late data ë¬¸ì œ**
    - ì´ë¯¸ ë‹«íŒ ìœˆë„ì— ì†í•˜ëŠ” ëŠ¦ì€ ì´ë²¤íŠ¸ëŠ” ì§‘ê³„ì— ë°˜ì˜ ë¶ˆê°€.
- **í•˜ë“œ ì»·ì˜¤í”„(Hard cutoff)**
    - `Late Limit` ê°™ì€ ìœ ì˜ˆ ê¸°ê°„(grace period)ì´ ì—†ìœ¼ë©´ ëŠ¦ê²Œ ë„ì°©í•œ ì´ë²¤íŠ¸ëŠ” ê·¸ëƒ¥ ë¬´ì‹œë¨.

> âœ… ì˜ˆ: `2025-06-05 12:00:00`ì— ìœˆë„ê°€ ë‹«íˆë©´, `12:00:01`ì— ë„ì°©í•œ í•´ë‹¹ ìœˆë„ ì´ë²¤íŠ¸ëŠ” íê¸°ë¨.

## 2. ê²½ê³„ ëª°ë¦¼(Traffic Spike at Boundary)ì˜ ë¬¸ì œ

ë§ì”€í•˜ì‹  ì´ ë‘ ë²ˆì§¸ ì§ˆë¬¸ì€ ì‹¤ë¬´ì ìœ¼ë¡œ ì•„ì£¼ ì¤‘ìš”í•©ë‹ˆë‹¤.

> â“ "ê³ ì • ê¸¸ì´ ìœˆë„ ë°©ì‹ì—ì„œ ë°”ë¡œ ì§ì „ ìœˆë„ ì¢…ë£Œ ì‹œì ê³¼ ë‹¤ìŒ ìœˆë„ ì‹œì‘ ì‹œì ì— ì´ë²¤íŠ¸ê°€ ëª°ë¦¬ë©´ ì–´ë–»ê²Œ í• ê²ƒì¸ê°€?

### ğŸ”¥ ë°œìƒ ì›ì¸

- ì‹œìŠ¤í…œ ë˜ëŠ” ì‚¬ìš©ìê°€ ì£¼ê¸°ì ìœ¼ë¡œ ë³´ë‚´ëŠ” ì´ë²¤íŠ¸ (ex: í¬ë¡  ì¡, ì„¼ì„œ ì‹ í˜¸, ì‚¬ìš©ì ë™ê¸°í™” ë“±)
- íŠ¸ë˜í”½ì´ **ì •ê°**, **1ë¶„ ê°„ê²©**, **10ì´ˆ ê°„ê²©**ì— ì§‘ì¤‘

### ğŸ’£ ë¬¸ì œ

- **ì´ì „ ìœˆë„**ëŠ” ê³¼ë°€ â†’ ì²˜ë¦¬ ì§€ì—° / ìœ ì‹¤ ê°€ëŠ¥
- **ë‹¤ìŒ ìœˆë„**ëŠ” ë¹„ì–´ ìˆìŒ â†’ í†µê³„ì  ì™œê³¡
- Late ì²˜ë¦¬ ì—†ì´ í•˜ë“œ ì»·ì˜¤í”„ë©´ **ë°ì´í„° ìœ ì‹¤**
- íƒ€ì„ì¡´ ì˜¤ì°¨, í´ëŸ­ ì§€ì—°, ë„¤íŠ¸ì›Œí¬ ì§€ì—°ê¹Œì§€ ê²¹ì¹˜ë©´ ì‹¬ê°

## 3. í•´ê²° ë°©ë²•

| ì „ëµ                     | ì„¤ëª…                                                                   |
| ---------------------- | -------------------------------------------------------------------- |
| **Grace Period ì¶”ê°€**    | Kafka Streams ë“±ì—ì„œ `grace(period)` ì„¤ì • â†’ ë‹«íŒ ìœˆë„ë„ ì¼ì • ì‹œê°„ ìœ ì˜ˆí•˜ë©° late ì´ë²¤íŠ¸ ìˆ˜ìš© |
| **Watermark ê¸°ë°˜ ì§€ì—° í—ˆìš©** | Apache Flink, Beam ë“±ì—ì„œëŠ” watermarkë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìœˆë„ ë‹«ê¸° ì‹œì  ê²°ì •                  |
| **Sliding Window ë„ì…**  | ìœˆë„ê°€ ê²¹ì³ì§€ë¯€ë¡œ ê²½ê³„ ê·¼ì²˜ ì´ë²¤íŠ¸ê°€ ì¤‘ë³µë˜ë©´ì„œ ì§‘ê³„ ë³´ì™„ ê°€ëŠ¥                                  |
| **Session Window ì „í™˜**  | ìœ ì € ì„¸ì…˜, ì´ë²¤íŠ¸ ë©ì–´ë¦¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìœ ë™ì ì¸ ìœˆë„ ìƒì„±í•˜ì—¬ ê²½ê³„ ë¬¸ì œ í•´ì†Œ                           |
| **Duplicate Handling** | late data ì²˜ë¦¬ ì‹œ deduplication ì „ëµ í•„ìš”                                   |

|ìƒí™©|ì²˜ë¦¬ ë°©ë²•|
|---|---|
|ê³ ì •ëœ ì‹œê°„ ë‹¨ìœ„ë¡œ ì§‘ê³„ í•„ìš”|Fixed Window + Grace|
|ê²½ê³„ ì§‘ì¤‘ íŠ¸ë˜í”½ ì¡´ì¬|Sliding Window or Session Windowë¡œ ì „í™˜|
|ìœ ì… ì§€ì—° í—ˆìš© í•„ìš”|Watermark ë˜ëŠ” Graceë¡œ ìœ ì˜ˆ ì‹œê°„ ë¶€ì—¬|
|ì •í™•í•œ ì§‘ê³„ í•„ìš”|Deduplication, checkpointing, ì •í™•í•œ íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ì¤€ í•„ìš”|


## ë¡œê·¸ ê¸°ë°˜ ì²˜ë¦¬ ë°©ë²•

### 1. ë¡œê·¸ ê¸°ë°˜ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ ì‹œìŠ¤í…œ (Kafka ë“±)ì—ì„œì˜ Late Limit ì²˜ë¦¬

Kafka, Kinesis ë“± **ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë° ì‹œìŠ¤í…œ**ì„ ê¸°ë°˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²½ìš°ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ Late ì´ë²¤íŠ¸ ì œí•œ(Late Limit)ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

#### Event Timestamp + Watermark ê¸°ë°˜ ì²˜ë¦¬

- ê° ì´ë²¤íŠ¸ì—ëŠ” `event_time` í•„ë“œê°€ ìˆê³ , ì²˜ë¦¬ ì‹œìŠ¤í…œ(Flink, Kafka Streams ë“±)ì€ `processing_time`ê³¼ ë¹„êµí•˜ì—¬ **ì–¼ë§ˆë‚˜ ëŠ¦ì€ ì´ë²¤íŠ¸ì¸ì§€ íŒë‹¨**í•©ë‹ˆë‹¤.
    
- ì˜ˆ: ì´ë²¤íŠ¸ê°€ `2024-06-04T12:00:00`ì´ê³  í˜„ì¬ watermarkê°€ `2024-06-04T12:05:00`ì´ë©´, ì´ ì´ë²¤íŠ¸ëŠ” 5ë¶„ Late
    

âœ… ì²˜ë¦¬ ì¡°ê±´:

- `allowed_lateness` (ì˜ˆ: 2ë¶„) ì„¤ì •
- `lateness > allowed_lateness`ì¸ ê²½ìš° ì´ë²¤íŠ¸ **ë“œë¡­**


## Reference

- [Rate Limit ì•Œê³ ë¦¬ì¦˜ ì—¬ëŸ¬ ì¢…ë¥˜](https://news.hada.io/topic?id=14869) 
- **GCRA ì•Œê³ ë¦¬ì¦˜**: rate limitingì— ë” ë‚˜ì€ ì•Œê³ ë¦¬ì¦˜ì´ë¼ê³  ìƒê°í•¨. ë” ë„ë¦¬ ì•Œë ¤ì§€ê³  ì‚¬ìš©ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŒ.
	- [GCRA êµ¬í˜„ ì˜ˆì œ](https://medium.com/smarkets/implementing-gcra-in-python-5df1f11aaa96)
	- [GCRA ìœ„í‚¤í”¼ë””ì•„](https://en.m.wikipedia.org/wiki/Generic_cell_rate_algorithm)
